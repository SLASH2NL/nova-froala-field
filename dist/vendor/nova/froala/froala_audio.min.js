webpackJsonp([3],{27:function(e,a,o){"use strict";(function(e){function a(e,a,o){return a in e?Object.defineProperty(e,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[a]=o,e}var o,t;o=e,t=window._,o.extend(o.FE.POPUP_TEMPLATES,{"audio.insert":"[_BUTTONS_][_BY_URL_LAYER_][_UPLOAD_LAYER_][_PROGRESS_BAR_]","audio.edit":"[_BUTTONS_]"}),o.extend(o.FE.DEFAULTS,{audioAllowedTypes:["mp3","mpeg","x-m4a"],audioEditButtons:["audioReplace","audioRemove","|","audioAutoplay","audioAlign"],audioInsertButtons:["audioBack","|","audioByURL","audioUpload"],audioMove:!0,audioSplitHTML:!1,audioUpload:!0,audioUploadMethod:"POST",audioUploadParam:"file",audioUploadParams:{},audioUploadURL:"https://i.froala.com/upload"}),o.FE.PLUGINS.audio=function(e){var i,r=(a(i={},1,"No link in upload response."),a(i,2,"Error during file upload."),a(i,4,"Parsing response failed."),a(i,8,"Unsupported file type - please provide an audio file."),i),n=null,s=function(a){a||(a=e.$el.find(".fr-audio")),a.length&&(e.toolbar.enable(),a.removeClass("fr-active"),n=null)},u=function(){e.popups.get("audio.insert").find("input, button").prop("disabled",!1).val("").trigger("change")},d=function(){e.popups.onRefresh("audio.insert",u),e.popups.onHide("audio.insert",e.audio.hideProgressBar);var a=e.opts.audioInsertButtons;e.opts.audioUpload||(a=t.omit(a,"audioUpload"));var i=a.length<2?"":'<div class="fr-buttons">\n                '+e.button.buildList(a)+"\n            </div>",r='<div class="fr-audio-by-url-layer fr-layer" id="fr-audio-by-url-layer-'+e.id+'">\n                <div class="fr-input-line">\n                    <input id="fr-audio-by-url-layer-text-'+e.id+'" type="text" placeholder="'+e.language.translate("Paste in an audio URL")+'" tabIndex="1" aria-required="true" />\n                </div>\n                <div class="fr-action-buttons">\n                    <button type="button" class="fr-command fr-submit" data-cmd="audioInsertByURL" tabIndex="2" role="button">'+e.language.translate("Insert")+"</button>\n                </div>\n            </div>",n=e.opts.audioAllowedTypes.map(function(e){return"audio/"+e}).join(","),s='<div class="fr-audio-upload-layer fr-file-upload-layer fr-layer" id="fr-audio-upload-layer-'+e.id+'">\n                <strong>'+e.language.translate("Drop audio")+"</strong><br />("+e.language.translate("or click")+')\n                <div class="fr-form">\n                    <input type="file" accept="'+n+'" tabIndex="-1" aria-labelledby="fr-audio-upload-layer-'+e.id+'" role="button" />\n                </div>\n            </div>',d='<div class="fr-audio-progress-bar-layer fr-layer">\n                <h3 tabIndex="-1" class="fr-message">'+e.language.translate("Uploading")+'</h3>\n                <div class="fr-loader">\n                    <span class="fr-progress"></span>\n                </div>\n                <div class="fr-action-buttons">\n                    <button type="button" class="fr-command fr-dismiss" data-cmd="audioDismissError" tabIndex="2" role="button">\n                        '+e.language.translate("OK")+"\n                    </button>\n                </div>\n            </div>",l=e.popups.create("audio.insert",{buttons:i,by_url_layer:r,upload_layer:s,progress_bar:d});return function(a){e.events.$on(a,"dragover dragenter",".fr-audio-upload-layer",function(){return o(this).addClass("fr-drop"),!1},!0),e.events.$on(a,"dragleave dragend",".fr-audio-upload-layer",function(){return o(this).removeClass("fr-drop"),!1},!0),e.events.$on(a,"drop",".fr-audio-upload-layer",function(t){t.preventDefault(),t.stopPropagation(),o(this).removeClass("fr-drop");var i=t.originalEvent.dataTransfer;if(i&&i.files){var r=a.data("instance")||e;r.events.disableBlur(),r.audio.upload(i.files),r.events.enableBlur()}},!0),e.helpers.isIOS()&&e.events.$on(a,"touchstart",'.fr-audio-upload-layer input[type="file"]',function(){o(this).trigger("click")},!0),e.events.$on(a,"change",'.fr-audio-upload-layer input[type="file"]',function(){if(this.files){var t=a.data("instance")||e;t.events.disableBlur(),a.find("input:focus").blur(),t.events.enableBlur(),t.audio.upload(this.files)}o(this).val("")},!0)}(l),l},l=function(a){var o=e.popups.get("audio.insert")||d();o.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"),o.find(".fr-audio-progress-bar-layer").addClass("fr-active"),o.find(".fr-buttons").hide(),a&&f(a,0)},p=function(a,o){e.edit.on(),function(a){l();var o=e.popups.get("audio.insert").find(".fr-audio-progress-bar-layer");o.addClass("fr-error");var t=o.find("h3");t.text(e.language.translate(a)),e.events.disableBlur(),t.focus()}(r[a]),e.events.trigger("audio.error",[{code:a,message:r[a]},o])},f=function(a,o){var t=e.popups.get("audio.insert");if(t){var i=t.find(".fr-audio-progress-bar-layer");i.find("h3").text(e.language.translate(a)+(o?" "+o+"%":"")),i.removeClass("fr-error"),o?(i.find("div").removeClass("fr-indeterminate"),i.find("div > span").css("width",o+"%")):i.find("div").addClass("fr-indeterminate")}},c=function(a,i){e.edit.on(),f("Loading audio"),l("Loading audio");var r=!!n,u=r?function(a,o){var t=a.find("audio");return t.attr("src")===o&&t.attr({src:""}),a.addClass("fr-uploading"),t.off("canplaythrough loadeddata").off("error").on("canplaythrough loadeddata",function(){e.popups.hide("audio.insert"),a.removeClass("fr-uploading"),e.events.trigger("audio.loaded",[a]),s(a)}).on("error",function(o){a.addClass("fr-error").removeClass("fr-uploading"),e.audio.showEditPopup(a),e.events.trigger("audio.error",[a,o])}).attr({src:o}),a}(n,a):function(a,i){i||(i={});var r=o('<span contenteditable="false" draggable="true" class="fr-audio fr-uploading"><audio controls="controls" controlsList="nodownload"></audio></span>');r.toggleClass("fr-draggable",e.opts.audioMove),e.events.focus(!0),e.selection.restore(),e.undo.saveStep(),e.opts.audioSplitHTML?e.markers.split():e.markers.insert(),e.html.wrap();var n=e.$el.find(".fr-marker");return e.node.isLastSibling(n)&&n.parent().hasClass("fr-deletable")&&n.insertAfter(n.parent()),n.replaceWith(r),e.selection.clear(),r.find("audio").text(e.language.translate("Your browser does not support HTML5 audio.")).on("canplaythrough loadeddata",function(){e.popups.hide("audio.insert"),r.removeClass("fr-uploading"),e.events.trigger("audio.loaded",[r])}).on("error",function(a){e.popups.hide("audio.insert"),r.addClass("fr-error").removeClass("fr-uploading"),e.events.trigger("audio.error",[r,a])}).attr(t.mapKeys(i,function(e,a){return"data-"+t.kebabCase(a)})).attr({src:a}),r}(a,i);e.undo.saveStep(),e.events.trigger(r?"audio.replaced":"audio.inserted",[u])},g=!1,v=function(a){var t=o(this);if(g&&a&&"touchend"===a.type)return!0;if(e.edit.isDisabled())return a&&(a.stopPropagation(),a.preventDefault()),!1;e.toolbar.disable(),e.helpers.isMobile()&&(e.events.disableBlur(),e.$el.blur(),e.events.enableBlur()),n&&n.removeClass("fr-active"),n=t,t.addClass("fr-active"),e.opts.iframe&&e.size.syncIframe(),e.audio.showEditPopup(t),e.selection.clear();var i=e.doc.createRange();return i.selectNode(t[0]),e.selection.get().addRange(i),e.button.bulkRefresh(),!0};return{_init:function(){e.helpers.isMobile()&&(e.events.$on(e.$el,"touchstart","span.fr-audio",function(){g=!1}),e.events.$on(e.$el,"touchmove",function(){g=!0})),e.events.$on(e.$el,"mousedown","span.fr-audio",function(e){e.stopPropagation()}),e.events.$on(e.$el,"click touchend","span.fr-audio",v),e.events.on("mouseup window.mouseup",function(){return s()}),e.events.on("commands.mousedown",function(e){e.parents(".fr-toolbar").length&&s()})},showInsertPopup:function(){e.popups.get("audio.insert")||d(),e.opts.audioInsertButtons.some(function(a){return"audioByURL"===a?(e.audio.showLayer("audio-by-url"),!0):"audioUpload"===a&&(e.audio.showLayer("audio-upload"),!0)})},showEditPopup:function(a){var o,t,i="audio.edit";e.popups.get(i)||(o=e.opts.audioEditButtons,t=o.length<1?"":'<div class="fr-buttons">\n                '+e.button.buildList(o)+"\n            </div>",e.popups.create("audio.edit",{buttons:t})),e.popups.setContainer(i,e.$sc),e.popups.refresh(i);var r=a.find("audio"),n=r.offset(),s=n.left,u=n.top,d=r.outerHeight();e.popups.show(i,s+r.outerWidth()/2,u+d,d)},refreshByURLButton:function(a){e.popups.get("audio.insert").find(".fr-audio-by-url-layer").hasClass("fr-active")&&a.addClass("fr-active").attr("aria-pressed",!0)},refreshUploadButton:function(a){e.popups.get("audio.insert").find(".fr-audio-upload-layer").hasClass("fr-active")&&a.addClass("fr-active").attr("aria-pressed",!0)},autoplay:function(){if(!n)return!1;var e=n.find("audio"),a=e.prop("autoplay");e.prop({autoplay:!a})},align:function(a){if(!n)return!1;"center"===a&&(a=""),n.css({textAlign:a}),e.audio.showEditPopup(n)},refreshAutoplayButton:function(e){if(!n)return!1;var a=n.find("audio").prop("autoplay");e.toggleClass("fr-active",a).attr("aria-pressed",a)},refreshAlignButton:function(a){if(!n)return!1;var o=n.css("textAlign")||"center";a.children(":first").replaceWith(e.icon.create("audioAlign"+t.capitalize(o)))},refreshAlignDropdown:function(e,a){if(n){var o=n.css("textAlign")||"center";a.find('.fr-command[data-param1="'+o+'"]').addClass("fr-active").attr("aria-selected",!0)}},back:function(){n?e.audio.showEditPopup(n):(e.events.disableBlur(),e.selection.restore(),e.events.enableBlur(),e.popups.hide("audio.insert"),e.toolbar.showInline())},refreshBackButton:function(a){var o=n||e.opts.toolbarInline;a.toggleClass("fr-hidden",!o),a.next(".fr-separator").toggleClass("fr-hidden",!o)},showLayer:function(a){var o=e.popups.get("audio.insert");e.popups.setContainer("audio.insert",n?e.$sc:e.$tb);var t=void 0,i=void 0,r=0;if(n){var s=n.find("audio");r=s.outerHeight();var u=s.offset();t=u.left+s.width()/2,i=u.top+r}else if(e.opts.toolbarInline)i=o.offset().top-e.helpers.getPX(o.css("margin-top")),o.hasClass("fr-above")&&(i+=o.outerHeight());else{var d=e.$tb.find('.fr-command[data-cmd="insertAudio"]'),l=d.offset();t=l.left+d.outerWidth()/2,i=l.top+(e.opts.toolbarBottom?10:d.outerHeight()-10)}o.find(".fr-layer").removeClass("fr-active"),o.find(".fr-"+a+"-layer").addClass("fr-active"),e.popups.show("audio.insert",t,i,r),e.accessibility.focusPopup(o),e.popups.refresh("audio.insert")},hideProgressBar:function(a){var o=e.popups.get("audio.insert");if(o){o.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),o.find(".fr-audio-progress-bar-layer").removeClass("fr-active"),o.find(".fr-buttons").show();var t=e.$el.find("audio.fr-error");(a||t.length)&&(e.events.focus(),t.length&&(t.parent().remove(),e.undo.saveStep(),e.undo.run(),e.undo.dropRedo()),e.popups.hide("audio.insert"))}},insertByURL:function(a){if(!a){var o=e.popups.get("audio.insert");a=(o.find('.fr-audio-by-url-layer input[type="text"]').val()||"").trim(),o.find("input, button").prop({disabled:!0})}/^http/.test(a)||(a="https://"+a),c(a)},upload:function(a){if(!a||!a.length)return!1;if(!1===e.events.trigger("audio.beforeUpload",[a]))return!1;var o=a[0];if(!t.includes(e.opts.audioAllowedTypes,o.type.replace(/audio\//g,"")))return p(8),!1;if(!e.drag_support.formdata)return!1;var i=new FormData;t.each(e.opts.audioUploadParams,function(e,a){return i.append(e,a)}),i.append(e.opts.audioUploadParam,o);var r=e.opts.audioUploadURL,n=e.core.getXHR(r,e.opts.audioUploadMethod);n.onload=function(){f("Loading audio");var a=this.status,o=this.response,t=this.responseText;if(415!==a)if(a<200||a>=300)p(2,o||t);else try{var i=function(a){if(!1===e.events.trigger("audio.uploaded",[a],!0))return e.edit.on(),!1;var o=JSON.parse(a);return o.link?o:(p(1,a),!1)}(t);i&&c(i.link,i)}catch(e){p(4,o||t)}else p(8,JSON.parse(t))},n.onerror=function(){p(4,this.response||this.responseText||this.responseXML)},n.upload.onprogress=function(e){e.lengthComputable&&f("Uploading",e.loaded/e.total*100|0)},n.onabort=function(){e.edit.on(),e.audio.hideProgressBar(!0)},l(),e.events.disableBlur(),e.edit.off(),e.events.enableBlur();var s=e.popups.get("audio.insert");return s&&s.off("abortUpload").on("abortUpload",function(){4!==n.readyState&&n.abort()}),n.send(i),!0},replace:function(){n&&e.audio.showInsertPopup()},remove:function(){if(n){var a=n;if(!1!==e.events.trigger("audio.beforeRemove",[a])){e.popups.hideAll();var o=a[0];e.selection.setBefore(o)||e.selection.setAfter(o),a.remove(),e.selection.restore(),e.html.fillEmptyBlocks(),e.events.trigger("audio.removed",[a]),s(a)}}}}},o.FE.DefineIcon("insertAudio",{NAME:"volume-up"}),o.FE.RegisterCommand("insertAudio",{title:"Insert Audio",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){return this.popups.isVisible("audio.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("audio.insert")):this.audio.showInsertPopup()},plugin:"audio"}),o.FE.DefineIcon("audioByURL",{NAME:"link"}),o.FE.RegisterCommand("audioByURL",{title:"By URL",undo:!1,focus:!1,toggle:!0,callback:function(){this.audio.showLayer("audio-by-url")},refresh:function(e){this.audio.refreshByURLButton(e)}}),o.FE.DefineIcon("audioUpload",{NAME:"upload"}),o.FE.RegisterCommand("audioUpload",{title:"Upload Audio",undo:!1,focus:!1,toggle:!0,callback:function(){this.audio.showLayer("audio-upload")},refresh:function(e){this.audio.refreshUploadButton(e)}}),o.FE.RegisterCommand("audioDismissError",{title:"OK",undo:!1,callback:function(){this.audio.hideProgressBar(!0)}}),o.FE.RegisterCommand("audioInsertByURL",{undo:!0,focus:!0,callback:function(){this.audio.insertByURL()}}),o.FE.DefineIcon("audioAlignLeft",{NAME:"align-left"}),o.FE.DefineIcon("audioAlignRight",{NAME:"align-right"}),o.FE.DefineIcon("audioAlignCenter",{NAME:"align-justify"}),o.FE.DefineIcon("audioAlign",{NAME:"align-center"}),o.FE.RegisterCommand("audioAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",center:"None",right:"Align Right"},html:function(){var e=this;return'<ul class="fr-dropdown-list" role="presentation">\n                '+t.map(o.FE.COMMANDS.audioAlign.options,function(a,o){return'<li role="presentation">\n                <a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="audioAlign"\n                   data-param1="'+o+'" title="'+e.language.translate(a)+'">\n                    '+e.icon.create("audioAlign"+t.capitalize(o))+'\n                    <span class="fr-sr-only">'+e.language.translate(a)+"</span>\n                </a>\n            </li>"}).join("\n")+"\n            </ul>"},callback:function(e,a){this.audio.align(a)},refresh:function(e){this.audio.refreshAlignButton(e)},refreshOnShow:function(e,a){this.audio.refreshAlignDropdown(e,a)}}),o.FE.DefineIcon("audioAutoplay",{NAME:"play-circle"}),o.FE.RegisterCommand("audioAutoplay",{title:"Autoplay",toggle:!0,callback:function(){this.audio.autoplay()},refresh:function(e){this.audio.refreshAutoplayButton(e)}}),o.FE.DefineIcon("audioReplace",{NAME:"exchange"}),o.FE.RegisterCommand("audioReplace",{title:"Replace",undo:!1,focus:!1,popup:!0,refreshAfterCallback:!1,callback:function(){this.audio.replace()}}),o.FE.DefineIcon("audioRemove",{NAME:"trash"}),o.FE.RegisterCommand("audioRemove",{title:"Remove",callback:function(){this.audio.remove()}}),o.FE.DefineIcon("audioBack",{NAME:"arrow-left"}),o.FE.RegisterCommand("audioBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.audio.back()},refresh:function(e){this.audio.refreshBackButton(e)}}),o.FE.RegisterQuickInsertButton&&o.FE.RegisterQuickInsertButton("audio",{icon:"insertAudio",requiredPlugin:"audio",title:"Insert Audio",undo:!1,callback:function(){var e=prompt(this.language.translate("Paste the URL of the audio you want to insert."));e&&this.audio.insertByURL(e)}})}).call(a,o(1))}});